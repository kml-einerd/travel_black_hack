<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deal Radar - MilesAI</title>
    <link rel="stylesheet" href="../css/design-system.css">
    <link rel="stylesheet" href="../css/components.css">
    <style>
        .deals-grid {
            display: grid;
            gap: var(--space-6);
            grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
        }
        .deal-card__image {
            height: 180px;
            width: 100%;
            object-fit: cover;
            border-radius: var(--radius-lg);
            margin-bottom: var(--space-4);
            background-color: var(--color-bg-tertiary);
        }
        .deal-card__meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-2);
        }
        .urgency-badge {
            display: inline-flex;
            align-items: center;
            gap: var(--space-1);
        }
    </style>
</head>
<body>

    <nav class="container header-nav">
        <div class="header-nav__logo">MilesAI <span class="text-sm text-primary">Deal Radar</span></div>
        <div class="header-nav__menu">
            <a href="../index.html" class="header-nav__link">Dashboard</a>
            <a href="#" class="header-nav__link" style="color: var(--color-primary)">Deal Radar</a>
            <a href="../tools/card-simulator.html" class="header-nav__link">Cards</a>
            <a href="../courses/fundamentals.html" class="header-nav__link">Learn</a>
        </div>
    </nav>

    <main class="container">
        <header style="margin-bottom: var(--space-8); text-align: center;">
            <h1 class="section-title text-3xl" style="justify-content: center;"><span class="section-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-2.072-4-2.072-5.5C7.928 1 10.928 2 13 6c1.071 2.071 2.071 3.929 2.071 5.5a2.5 2.5 0 0 1-2.5 2.5c-.69 0-1.25-.56-1.25-1.25 0-1.38-.5-2-1-3-1.072-2.143-2.072-4-2.072-5.5C8.257 1.75 5.257 1.75 3 6c-1.071 2.071-2.071 3.929-2.071 5.5a2.5 2.5 0 0 0 2.5 2.5c.69 0 1.25-.56 1.25-1.25z"/></svg></span>Deal Radar</h1>
            <p class="text-lg" style="color: var(--color-text-secondary)">High-value, time-sensitive redemption opportunities.</p>
        </header>

        <div id="deals-container" class="deals-grid">
            <!-- Deals injected here -->
        </div>
    </main>

    <script type="module">
        import { initCountdowns } from '../js/components.js';
        import { formatCurrency } from '../js/utils.js';

        // Simulated Data (matching hot-deals.json / Schema 5.3)
        const hotDeals = [
            {
                "id": "deal-001",
                "type": "transfer_bonus",
                "title": "Amex 40% Transfer Bonus to Avianca LifeMiles",
                "description": "$600 extra value on 100K transfer",
                "expires_at": "2026-01-25T23:59:59Z",
                "priority": "high",
                "image": "../images/avianca-tail.svg",
                "cta": "Transfer Now"
            },
            {
                "id": "deal-002",
                "type": "card_bonus",
                "title": "Chase Ink Preferred 100K — Highest Ever Public Offer",
                "description": "$1,250 in travel value",
                "expires_at": "2026-02-15T23:59:59Z",
                "priority": "high",
                "image": "../images/chase-ink.svg",
                "cta": "Apply Now"
            },
            {
                "id": "deal-003",
                "type": "award_availability",
                "title": "ANA First Class Wide Open NYC-Tokyo March",
                "description": "110K Virgin points, $6K+ value",
                "expires_at": "2026-01-20T23:59:59Z",
                "priority": "urgent",
                "image": "../images/ana-cabin.svg",
                "cta": "Check Availability"
            },
            {
                "id": "deal-005",
                "type": "mistake_fare",
                "title": "⚡ MISTAKE FARE: LA to Bali $287 RT (Qatar)",
                "description": "Normally $1,200+. Book immediately.",
                "expires_at": "2026-01-14T18:00:00Z",
                "priority": "critical",
                "image": "../images/bali-landscape.svg",
                "cta": "Book Immediately"
            }
        ];

        const getUrgencyBadge = (priority, expires) => {
            if (priority === 'critical') return '<span class="badge badge--urgent">Expiring Soon</span>';
            if (priority === 'urgent') return '<span class="badge badge--accent">Limited Time</span>';
            return '<span class="badge badge--info">New Arrival</span>';
        };

        const renderDeals = () => {
            const container = document.getElementById('deals-container');
            container.innerHTML = hotDeals.map(deal => `
                <article class="card ${deal.priority === 'critical' ? 'card--featured' : ''}">
                    <div class="card__header">
                        ${getUrgencyBadge(deal.priority)}
                        <span class="text-xs text-muted">Expires in: <span class="js-countdown" data-expires="${deal.expires_at}"></span></span>
                    </div>
                    <img src="${deal.image}" class="deal-card__image" alt="${deal.title}">
                    <div class="card__body">
                        <h3 class="card__title" style="margin-bottom: var(--space-2)">${deal.title}</h3>
                        <p class="text-sm text-primary" style="font-weight: 600;">${deal.description}</p>
                    </div>
                    <footer class="card__footer">
                        <button class="btn btn-primary" style="width: 100%">${deal.cta}</button>
                    </footer>
                </article>
            `).join('');

            initCountdowns();
        };

        renderDeals();
    </script>
</body>
</html>
