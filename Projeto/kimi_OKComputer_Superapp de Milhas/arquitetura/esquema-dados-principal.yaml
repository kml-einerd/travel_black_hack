# MilesAI - Arquitetura de Dados Principal
# Base para todos os recursos do superapp

version: "1.0"
description: "Arquitetura de dados para o superapp MilesAI - milhas e viagens"

# =====================================================
# ESTRUTURAS DE DADOS FUNDAMENTAIS
# =====================================================

# 1. USUÁRIOS
usuario:
  id: string (uuid)
  email: string
  nome: string
  telefone: string
  data_nascimento: date
  endereco: object
  perfil: object
  created_at: timestamp
  updated_at: timestamp
  
  # Perfil do usuário
  perfil:
    nivel_conhecimento: enum [iniciante, intermediario, avancado, expert]
    objetivos_viagem: array [economia, luxo, negocios, familia]
    preferencias_airlines: array
    preferencias_hoteis: array
    gastos_mensais: number
    historico_pontos: array
    cartoes_atuais: array
    metas_viagem: array

# 2. CARTÕES DE CRÉDITO
cartao_credito:
  id: string (uuid)
  nome: string
  emissor: string
  bandeira: string
  tipo: enum [cashback, pontos, milhas, hibrido]
  
  # Dados financeiros
  anuidade: number
  taxa_juros: number
  limite_minimo: number
  
  # Recompensas
  estrutura_recompensas: object
  bonus_boas_vindas: object
  categorias_bonus: array
  
  # Benefícios
  beneficios: array
  creditos_mensais: array
  seguros: array
  
  # Tracking
  programa_afiliado: string
  comissao_afiliado: number
  url_afiliado: string
  
  # Metadados
  data_lancamento: date
  ultima_atualizacao: date
  ativo: boolean
  
  # Avaliações
  rating_geral: number
  avaliacoes_usuarios: array

# 3. PROGRAMAS DE PONTOS/MILHAS
programa_pontos:
  id: string (uuid)
  nome: string
  tipo: enum [transferivel, airline, hotel, cashback]
  
  # Valores
  valor_base_ponto: number (cents per point)
  valores_por_categoria: object
  
  # Parceiros
  parceiros_transferencia: array
  taxas_transferencia: object
  bonus_transferencia: array
  
  # Redenção
  opcoes_redencao: array
  valor_redencao_dinamico: boolean
  
  # Tracking
  url_tracking: string
  atualizacao_valores: timestamp

# 4. VOOS E AEROLINHAS
voo:
  id: string (uuid)
  numero_voo: string
  companhia_aerea: object
  origem: object
  destino: object
  
  # Horários
  data_partida: datetime
  data_chegada: datetime
  duracao: string
  
  # Tarifas
  tarifas_disponiveis: array
  assentos_disponiveis: object
  
  # Award travel
  disponibilidade_award: object
  custo_milhas: object
  taxas_encargos: number
  
  # Tracking
  data_consulta: timestamp
  fonte_dados: string

# 5. HOTEIS E ALOJAMENTOS
hotel:
  id: string (uuid)
  nome: string
  cadeia: string
  localizacao: object
  
  # Categorização
  categoria: enum [budget, standard, premium, luxury]
  classificacao: number
  
  # Preços
  precos_dinheiro: object
  precos_pontos: object
  disponibilidade: object
  
  # Benefícios
  beneficios_elite: array
  upgrades_disponiveis: array
  
  # Tracking
  programas_participacao: array
  url_reserva: string

# 6. OFERTAS E DEALS
oferta:
  id: string (uuid)
  tipo: enum [cartao, voo, hotel, transfer_bonus, promo]
  titulo: string
  descricao: string
  
  # Detalhes
  valor_minimo: number
  valor_maximo: number
  desconto_percentual: number
  
  # Validade
  data_inicio: datetime
  data_fim: datetime
  data_publicacao: datetime
  
  # Tracking
  url_oferta: string
  codigo_promocional: string
  prioridade: number
  
  # Afiliado
  programa_afiliado: string
  comissao: number
  
  # Status
  ativa: boolean
  aprovada: boolean

# 7. CONTEÚDO EDUCACIONAL
conteudo:
  id: string (uuid)
  tipo: enum [artigo, video, podcast, ebook, curso, guia]
  titulo: string
  subtitulo: string
  conteudo: string (markdown)
  
  # Categorização
  categoria: string
  tags: array
  nivel_dificuldade: enum [iniciante, intermediario, avancado]
  
  # Metadados
  autor: string
  duracao_minutos: number
  palavras: number
  
  # Mídia
  url_imagem_capa: string
  url_video: string
  url_audio: string
  
  # Tracking
  visualizacoes: number
  curtidas: number
  compartilhamentos: number
  
  # SEO
  meta_description: string
  keywords: array
  slug: string

# 8. CURSOS
modulo_curso:
  id: string (uuid)
  curso_id: string (uuid)
  titulo: string
  ordem: number
  
  # Conteúdo
  aulas: array
  recursos: array
  exercicios: array
  
  # Progresso
  duracao_aproximada: number
  dificuldade: string
  
  # Metadados
  objetivos_aprendizagem: array
  pre_requisitos: array

# 9. EBOOKS
ebook:
  id: string (uuid)
  titulo: string
  subtitulo: string
  autor: string
  
  # Conteúdo
  capitulos: array
  numero_paginas: number
  formato: string
  
  # Design
  template_design: string
  cores_principais: array
  fontes: array
  
  # Geração IA
  prompts_ia: object
  dados_fonte: array
  
  # Distribuição
  url_download: string
  preco: number
  upsells: array

# 10. SIMULAÇÕES E ESTRATÉGIAS
simulacao:
  id: string (uuid)
  usuario_id: string (uuid)
  tipo: enum [acumulo, redencao, comparacao, upgrade]
  
  # Parâmetros
  gastos_mensais: object
  cartoes_simulados: array
  prazo_meses: number
  
  # Resultados
  pontos_projetados: object
  valor_estimado: number
  comparativos: array
  
  # Recomendações
  acoes_sugeridas: array
  melhorias_identificadas: array
  
  # Tracking
  data_criacao: timestamp
  data_ultima_atualizacao: timestamp

# 11. ALERTAS E NOTIFICAÇÕES
alerta:
  id: string (uuid)
  usuario_id: string (uuid)
  tipo: enum [oferta, expiracao, meta, sistema]
  
  # Conteúdo
  titulo: string
  mensagem: string
  prioridade: enum [baixa, media, alta, urgente]
  
  # Configuração
  ativo: boolean
  frequencia: enum [unico, diario, semanal, mensal]
  
  # Delivery
  enviado_email: boolean
  enviado_push: boolean
  data_envio: timestamp

# 12. AFILIADOS E TRACKING
afiliado:
  id: string (uuid)
  nome: string
  email: string
  
  # Programas
  programas_participando: array
  comissoes_totais: number
  pagamentos_recebidos: number
  
  # Tracking
  links_gerados: array
  clicks_totais: number
  conversoes: number
  
  # Dados bancários
  metodo_pagamento: string
  dados_bancarios: object

# 13. ANÁLISES E RELATÓRIOS
analise:
  id: string (uuid)
  tipo: enum [spending, rewards, portfolio, mercado]
  
  # Dados
  periodo_inicio: date
  periodo_fim: date
  metricas: object
  
  # Visualização
  graficos: array
  insights: array
  recomendacoes: array
  
  # Exportação
  formato_exportacao: array
  url_relatorio: string

# =====================================================
# RELACIONAMENTOS ENTRE COLEÇÕES
# =====================================================

relacionamentos:
  usuario -> simulacao: 1:N
  usuario -> alerta: 1:N
  usuario -> cartao_credito: N:M (through usuario_cartao)
  cartao_credito -> programa_pontos: N:M (through cartao_programa)
  programa_pontos -> parceiros_transferencia: N:M
  voo -> companhia_aerea: N:1
  hotel -> cadeia: N:1
  conteudo -> modulo_curso: 1:N
  curso -> ebook: 1:1

# =====================================================
# ÍNDICES PARA PERFORMANCE
# =====================================================

indices:
  - usuario.email: unique
  - cartao_credito.emissor: 1
  - cartao_credito.tipo: 1
  - programa_pontos.tipo: 1
  - oferta.data_fim: 1
  - oferta.ativa: 1
  - voo.data_partida: 1
  - hotel.localizacao.pais: 1
  - conteudo.tipo: 1
  - conteudo.categoria: 1
  - alerta.usuario_id: 1
  - alerta.prioridade: 1

# =====================================================
# CONFIGURAÇÕES DE SEGURANÇA
# =====================================================

seguranca:
  criptografia:
    - dados_bancarios
    - dados_pessoais.senha
    - tokens_acesso
  
  anonimizacao:
    - email_para_analises
    - localizacao_precisa
  
  auditoria:
    - acessos_usuario
    - modificacoes_dados
    - transacoes_financeiras

# =====================================================
# CONFIGURAÇÕES DE BACKUP
# =====================================================

backup:
  frequencia: diario
  retencao: 90_dias
  criptografia: AES-256
  regioes: [us-east-1, us-west-2]
  
  excecoes:
    - dados_temporarios
    - caches
    - logs_detalhados