<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Quick Guides - MilesAI</title>
  <link rel="stylesheet" href="../css/design-system.css">
  <link rel="stylesheet" href="../css/components.css">
  <script src="https://unpkg.com/lucide@latest"></script>
  <style>
    body { padding: var(--space-8); background: var(--color-bg-canvas); }

    .page-header {
      text-align: center;
      margin-bottom: var(--space-8);
    }

    .page-header__title {
      font-size: var(--text-4xl);
      font-weight: var(--font-bold);
      margin-bottom: var(--space-2);
    }

    .page-header__subtitle {
      color: var(--color-text-secondary);
      font-size: var(--text-lg);
    }

    .guides-container { max-width: 1200px; margin: 0 auto; }

    .guides-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
      gap: var(--space-6);
      margin-bottom: var(--space-8);
    }

    .guide-card {
      background: white;
      border-radius: var(--radius-2xl);
      overflow: hidden;
      box-shadow: var(--shadow-card);
      transition: all var(--transition-normal);
      cursor: pointer;
    }

    .guide-card:hover {
      box-shadow: var(--shadow-card-hover);
      transform: translateY(-4px);
    }

    .guide-card__image {
      width: 100%;
      height: 200px;
      object-fit: cover;
    }

    .guide-card__content {
      padding: var(--space-5);
    }

    .guide-card__icon {
      font-size: var(--text-3xl);
      margin-bottom: var(--space-2);
    }

    .guide-card__title {
      font-size: var(--text-xl);
      font-weight: var(--font-bold);
      color: var(--color-text-primary);
      margin-bottom: var(--space-3);
      line-height: var(--leading-tight);
    }

    .guide-card__meta {
      display: flex;
      gap: var(--space-4);
      margin-bottom: var(--space-3);
      font-size: var(--text-sm);
      color: var(--color-text-muted);
    }

    .guide-card__meta-item {
      display: flex;
      align-items: center;
      gap: var(--space-1);
    }

    .guide-card__summary {
      color: var(--color-text-secondary);
      line-height: var(--leading-relaxed);
      font-size: var(--text-sm);
    }

    .guide-card__difficulty {
      display: inline-block;
      padding: var(--space-1) var(--space-3);
      border-radius: var(--radius-full);
      font-size: var(--text-xs);
      font-weight: var(--font-semibold);
      text-transform: uppercase;
      margin-top: var(--space-3);
    }

    .guide-card__difficulty--beginner {
      background: var(--color-success-light);
      color: var(--color-success-dark);
    }

    .guide-card__difficulty--intermediate {
      background: var(--color-info-light);
      color: var(--color-info-dark);
    }

    .guide-card__difficulty--advanced {
      background: var(--color-warning-light);
      color: var(--color-warning-dark);
    }

    /* Modal Styles */
    .modal-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(15, 23, 42, 0.8);
      z-index: 1000;
      overflow-y: auto;
      padding: var(--space-8);
    }

    .modal-overlay--active {
      display: flex;
      align-items: flex-start;
      justify-content: center;
    }

    .modal {
      background: white;
      border-radius: var(--radius-2xl);
      max-width: 900px;
      width: 100%;
      margin: auto;
      box-shadow: var(--shadow-elevated);
      animation: modalSlideIn 0.3s ease-out;
    }

    @keyframes modalSlideIn {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .modal__header {
      position: relative;
      height: 300px;
      background-size: cover;
      background-position: center;
      border-radius: var(--radius-2xl) var(--radius-2xl) 0 0;
    }

    .modal__header-overlay {
      position: absolute;
      inset: 0;
      background: rgba(15, 23, 42, 0.6);
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      padding: var(--space-6);
      border-radius: var(--radius-2xl) var(--radius-2xl) 0 0;
    }

    .modal__close {
      position: absolute;
      top: var(--space-4);
      right: var(--space-4);
      width: 40px;
      height: 40px;
      border-radius: var(--radius-full);
      background: rgba(255, 255, 255, 0.9);
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: var(--text-xl);
      transition: all var(--transition-fast);
    }

    .modal__close:hover {
      background: white;
      transform: scale(1.1);
    }

    .modal__icon {
      font-size: var(--text-4xl);
      margin-bottom: var(--space-2);
    }

    .modal__title {
      font-size: var(--text-3xl);
      font-weight: var(--font-bold);
      color: white;
      margin-bottom: var(--space-2);
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    }

    .modal__meta {
      display: flex;
      gap: var(--space-4);
      color: rgba(255, 255, 255, 0.9);
      font-size: var(--text-sm);
    }

    .modal__content {
      padding: var(--space-8);
    }

    .guide-section {
      margin-bottom: var(--space-8);
    }

    .guide-section:last-child {
      margin-bottom: 0;
    }

    .guide-section__title {
      font-size: var(--text-xl);
      font-weight: var(--font-bold);
      color: var(--color-text-primary);
      margin-bottom: var(--space-3);
      display: flex;
      align-items: center;
      gap: var(--space-2);
    }

    .guide-section__content {
      color: var(--color-text-secondary);
      line-height: var(--leading-relaxed);
      margin-bottom: var(--space-4);
    }

    .guide-section__points {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .guide-section__points li {
      padding: var(--space-3);
      padding-left: var(--space-8);
      position: relative;
      background: var(--color-bg-secondary);
      margin-bottom: var(--space-2);
      border-radius: var(--radius-lg);
      color: var(--color-text-secondary);
      line-height: var(--leading-relaxed);
    }

    .guide-section__points li::before {
      content: '✓';
      position: absolute;
      left: var(--space-3);
      color: var(--color-success);
      font-weight: var(--font-bold);
      font-size: var(--text-lg);
    }

    .action-items {
      background: var(--color-primary-light);
      padding: var(--space-6);
      border-radius: var(--radius-xl);
      margin-bottom: var(--space-6);
    }

    .action-items__title {
      font-size: var(--text-lg);
      font-weight: var(--font-bold);
      color: var(--color-primary-dark);
      margin-bottom: var(--space-4);
      display: flex;
      align-items: center;
      gap: var(--space-2);
    }

    .action-items__list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .action-items__list li {
      padding: var(--space-2) 0 var(--space-2) var(--space-6);
      position: relative;
      color: var(--color-text-primary);
      font-weight: var(--font-medium);
    }

    .action-items__list li::before {
      content: '□';
      position: absolute;
      left: 0;
      font-size: var(--text-xl);
      color: var(--color-primary);
    }

    .resources {
      background: var(--color-bg-secondary);
      padding: var(--space-5);
      border-radius: var(--radius-xl);
    }

    .resources__title {
      font-size: var(--text-base);
      font-weight: var(--font-bold);
      color: var(--color-text-primary);
      margin-bottom: var(--space-3);
    }

    .resources__list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .resources__list li {
      padding: var(--space-2) 0;
    }

    .resources__link {
      color: var(--color-primary);
      text-decoration: none;
      font-weight: var(--font-medium);
      display: flex;
      align-items: center;
      gap: var(--space-2);
      transition: color var(--transition-fast);
    }

    .resources__link:hover {
      color: var(--color-primary-dark);
    }

    @media (max-width: 768px) {
      .guides-grid { grid-template-columns: 1fr; }
      .modal-overlay { padding: var(--space-4); }
      .modal__header { height: 200px; }
      .modal__content { padding: var(--space-5); }
    }
  </style>
</head>
<body>
  <div class="guides-container">
    <header class="page-header">
      <h1 class="page-header__title">
        <i data-lucide="book-open" class="icon icon--lg"></i>
        <span>Quick Guides</span>
      </h1>
      <p class="page-header__subtitle">
        Focused, actionable guides to master travel hacking fundamentals
      </p>
    </header>

    <div class="guides-grid" id="guides-grid">
      <!-- Guides loaded dynamically -->
    </div>
  </div>

  <!-- Modal -->
  <div class="modal-overlay" id="modal-overlay">
    <div class="modal" id="modal">
      <!-- Modal content loaded dynamically -->
    </div>
  </div>

  <script>
    let guides = [];

    async function loadGuides() {
      try {
        const response = await fetch('../data/quick-guides.json');
        const data = await response.json();
        guides = data.guides;
        renderGuides();
      } catch (error) {
        console.error('Error loading guides:', error);
      }
    }

    function renderGuides() {
      const grid = document.getElementById('guides-grid');
      grid.innerHTML = guides.map(guide => `
        <article class="guide-card" onclick="openGuide('${guide.id}')">
          <img src="${guide.cover_image}" alt="${guide.title}" class="guide-card__image">
          <div class="guide-card__content">
            <div class="guide-card__icon">${guide.icon}</div>
            <h3 class="guide-card__title">${guide.title}</h3>
            <div class="guide-card__meta">
              <span class="guide-card__meta-item">
                <i data-lucide="book-open" class="icon icon--xs"></i>
                <span>${guide.read_time} read</span>
              </span>
              <span class="guide-card__meta-item">
                <i data-lucide="calendar" class="icon icon--xs"></i>
                <span>${formatDate(guide.last_updated)}</span>
              </span>
            </div>
            <p class="guide-card__summary">${guide.summary}</p>
            <span class="guide-card__difficulty guide-card__difficulty--${guide.difficulty}">
              ${guide.difficulty}
            </span>
          </div>
        </article>
      `).join('');
      lucide.createIcons();
    }

    function openGuide(guideId) {
      const guide = guides.find(g => g.id === guideId);
      if (!guide) return;

      const modal = document.getElementById('modal');
      modal.innerHTML = `
        <div class="modal__header" style="background-image: url('${guide.cover_image}')">
          <button class="modal__close" onclick="closeModal()">✕</button>
          <div class="modal__header-overlay">
            <div class="modal__icon">${guide.icon}</div>
            <h2 class="modal__title">${guide.title}</h2>
            <div class="modal__meta">
              <span><i data-lucide="book-open" class="icon icon--xs"></i> ${guide.read_time} read</span>
              <span>•</span>
              <span>${guide.difficulty.toUpperCase()}</span>
              <span>•</span>
              <span>Updated ${formatDate(guide.last_updated)}</span>
            </div>
          </div>
        </div>

        <div class="modal__content">
          ${guide.sections.map(section => `
            <div class="guide-section">
              <h3 class="guide-section__title">${section.title}</h3>
              <p class="guide-section__content">${section.content}</p>
              <ul class="guide-section__points">
                ${section.key_points.map(point => `<li>${point}</li>`).join('')}
              </ul>
            </div>
          `).join('')}

          <div class="action-items">
            <h4 class="action-items__title">
              <i data-lucide="check-square" class="icon icon--sm"></i>
              <span>Action Items</span>
            </h4>
            <ul class="action-items__list">
              ${guide.action_items.map(item => `<li>${item}</li>`).join('')}
            </ul>
          </div>

          <div class="resources">
            <h4 class="resources__title">
              <i data-lucide="link" class="icon icon--xs"></i>
              Helpful Resources
            </h4>
            <ul class="resources__list">
              ${guide.resources.map(resource => `
                <li>
                  <a href="${resource.url}" class="resources__link">
                    <span>→</span>
                    <span>${resource.name}</span>
                  </a>
                </li>
              `).join('')}
            </ul>
          </div>
        </div>
      `;

      document.getElementById('modal-overlay').classList.add('modal-overlay--active');
      document.body.style.overflow = 'hidden';
      lucide.createIcons();
    }

    function closeModal() {
      document.getElementById('modal-overlay').classList.remove('modal-overlay--active');
      document.body.style.overflow = '';
    }

    function formatDate(dateStr) {
      const date = new Date(dateStr);
      return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
    }

    // Close modal on overlay click
    document.getElementById('modal-overlay').addEventListener('click', (e) => {
      if (e.target.id === 'modal-overlay') {
        closeModal();
      }
    });

    // Close modal on Escape key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        closeModal();
      }
    });

    document.addEventListener('DOMContentLoaded', loadGuides);
  </script>

  <script>
    lucide.createIcons();
  </script>
</body>
</html>
